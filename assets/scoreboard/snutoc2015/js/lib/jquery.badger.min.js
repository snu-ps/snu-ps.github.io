// Badger v1.0 by Daniel Raftery
// http://thrivingkings.com/badger
//
// http://twitter.com/ThrivingKings

// modified by Jongwook Choi, under the MIT License

(function( $ )
	{
	$.fn.badger = function(badge, callback) 
		{
  		var badgerExists = this.find('> .Badger').html();
  		
  		// Clear the badge
  		if(!badge)
  			{
  			if(badgerExists)
  				{ this.find('> .Badger').remove(); }
  			}
  		else
  			{
			// Figuring out badge data
			var oldBadge = this.find('> .Badger .Badge').text();
			if(typeof(badge) == 'string')
			{
			if(badge.charAt(0)=='+')
				{ 
				if(isNaN(badge.substr(1)))
					{ badge = oldBadge + badge.substr(1); }
				else
					{ badge = Math.round(Number(oldBadge) + Number(badge.substr(1))); }
				}
			else if(badge.charAt(0)=='-')
				{ 
				if(isNaN(badge.substr(1)))
					{ badge = oldBadge - badge.substr(1); }
				else
					{ badge = Math.round(Number(oldBadge) - Number(badge.substr(1))); }
				}
			}
				
				
			// Don't add duplicates
			if(badgerExists)
				{ this.find('> .Badger .Badge').html(badge); }
			else
				{ this.append('<div class="badger-outter Badger"><div class="badger-inner"><p class="badger-badge Badge">'+badge+'</p></div></div>'); }
				
			// Badger text or number class
			if(isNaN(badge))
				{ this.find('> .Badger .Badge').removeClass('badger-number').addClass('badger-text'); }
			else
				{ this.find('> .Badger .Badge').removeClass('badger-text').addClass('badger-number'); }
			// Send back badge
			if(callback) { callback(badge); }
			}
		return this.find('> .Badger');
		};
})( jQuery );

